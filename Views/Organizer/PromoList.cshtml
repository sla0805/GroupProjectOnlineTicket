@using System.Linq
@model IEnumerable<OnlineTicket.ViewModels.PromotionViewModel>
<div class="container mt-8">

    <!-- TempData Messages -->
    @if (TempData["SuccessMessage"] != null)
    {
        <div class="bg-green-100 text-green-800 p-3 rounded mb-4 flex justify-between items-center shadow">
            <span>@TempData["SuccessMessage"]</span>
            <button type="button" class="ml-4 font-bold text-lg" onclick="this.parentElement.style.display='none'">×</button>
        </div>
    }
    @if (TempData["ErrorMessage"] != null)
    {
        <div class="bg-red-100 text-red-800 p-3 rounded mb-4 flex justify-between items-center shadow">
            <span>@TempData["ErrorMessage"]</span>
            <button type="button" class="ml-4 font-bold text-lg" onclick="this.parentElement.style.display='none'">×</button>
        </div>
    }

    <!-- Header Section -->
    <div class="mb-8 p-6 rounded-xl bg-gradient-to-r from-indigo-500 to-indigo-400 text-white shadow-xl hover:shadow-2xl transition duration-500 flex flex-col md:flex-row md:justify-between md:items-start gap-4">
        <div class="text-center md:text-left">
            <h1 class="text-4xl md:text-5xl font-extrabold drop-shadow-lg mb-2">
                Manage Promotions
            </h1>
            <p class="text-lg md:text-xl font-medium drop-shadow-sm">
                View, add, edit, or delete promotional codes for your events and ticket types.
            </p>
        </div>
        <div class="flex gap-3 flex-wrap justify-center md:justify-start mt-4 md:mt-0">
            <a asp-action="AddPromotion" class="inline-flex items-center px-6 py-3 bg-green-600 rounded-lg shadow-lg hover:bg-green-700 hover:scale-105 transition transform font-semibold text-lg">
                <i class="fa-solid fa-plus mr-2"></i> Add Promotion
            </a>
            <a asp-action="Dashboard" asp-controller="Organizer" class="inline-flex items-center px-6 py-3 bg-gray-700 rounded-lg shadow-lg hover:bg-gray-800 hover:scale-105 transition transform font-semibold text-lg">
                <i class="fa-solid fa-arrow-left mr-2"></i> Back to Dashboard
            </a>
        </div>
    </div>

    <!-- Promotions Table Card -->
    <div class="bg-white p-6 rounded-xl shadow-lg hover:shadow-xl transition">
        <table class="table table-hover align-middle mb-0">
            <thead class="table-dark">
                <tr>
                    <th>Name</th>
                    <th>Code</th>
                    <th>Discount (%)</th>
                    <th>Event</th>
                    <th>Ticket Type</th>
                    <th>Status</th>
                    <th class="text-center">Actions</th>
                </tr>
            </thead>
            <tbody>
                @foreach (var promo in Model)
                {
                    <tr class="hover:bg-gray-50 transition">
                        <td class="fw-bold">@promo.Name</td>
                        <td>@promo.Code</td>
                        <td>@promo.DiscountPercentage %</td>
                        <td>@promo.EventName</td>
                        <td>@promo.TicketTypeName</td>
                        <td>
                            @if (promo.IsActive)
                            {
                                <span class="badge bg-success">Active</span>
                            }
                            else
                            {
                                <span class="badge bg-secondary">Inactive</span>
                            }
                        </td>
                        <td class="text-center flex gap-1 justify-center">
                            <a asp-action="EditPromotion" asp-route-id="@promo.PromotionId" class="btn btn-sm btn-primary hover:scale-105 transition transform">Edit</a>
                            <form asp-action="DeletePromotion" method="post" onsubmit="return confirm('Are you sure you want to delete this promotion?');">
                                <input type="hidden" name="id" value="@promo.PromotionId" />
                                <button type="submit" class="btn btn-sm btn-danger hover:scale-105 transition transform">Delete</button>
                            </form>
                        </td>
                    </tr>
                }
            </tbody>
        </table>

        @if (!Model.Any())
        {
            <p class="text-gray-500 text-center mt-4 italic">No promotions available. Click "Add Promotion" to create one.</p>
        }
    </div>
</div>
